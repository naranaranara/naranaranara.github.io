---
layout: post
title:  "Markdown 101"
toc: true          # 우측 목차
toc_sticky: true   # 스크롤해도 고정
date: 2025-10-27
tags: [markdown, blog]
use_math: true
mathjax: true
---
## My-FEM-Study-Log
이 공간은 대학원 준비를 위해 유한요소법(FEM) 이론을 학습하고, 이를 C++ 언어로 직접 구현해 본 프로젝트들을 모아둔 포트폴리오 겸 스터디 로그입니다. 복잡한 수식으로만 존재하던 이론을 코드로 옮기는 과정은 쉽지 않았지만, C++로 솔버를 완성하고 Paraview를 통해 시각화된 결과물을 얻었을 때의 성취감을 기록하고 싶었습니다. 각 프로젝트는 제가 어떤 문제를 어떻게 이해하고 해결했는지, 그리고 그 과정에서 무엇을 배웠는지를 보여줍니다.

## 캔틸레버 빔 해석

e.g. linear elliptic pde를 사용하는 경우  
- 1D heat conduction at steady state
- 1D mass diffusion at steady state  
- 1D elasticity
<br>
<br>

![alt text](image.png)

$u_g$: Applied displacement at $x=L$  
$t$: Applied traction at $x=L$  
$f$: distributed body force

### Strong form:  
Find $u(x)$: $(o,L)$ $\mapsto$ $\mathbb{R}$  

given $u(0)=u_o$ or $t$, $f(x)$, the constitutive relation $\sigma = Eu_{,x}$  
such that $\frac{d\sigma}{dx}+f=0$ in $(0,L)$  

different equation with the boundary conditions: &nbsp;&nbsp; $u(0)=u_o$  
and either $u(L) = u_g$ or $\sigma(L) = t$  


### 경계조건 종류
  1. Dirichlet B.C. (변위경계조건)  
  $u(0) = u_o$, $u(L) = u_g$  
  2. Neuman B.C. (미분방정식)  
  $\sigma(L) = t$  
  From constitutive relation $$
 \Rightarrow (E\,\underbrace{u_{,x}}_{\text{도함수}})\big|_{x=L}=t
 $$
  <br>
For elasticity: Dirichlet boundary condition is called the diplacement B.C. and Neuman B.C. is called traction B.C.

경계조건 경우의 수:  
1. Dirichlet B.C.s at $x=0$ and $x=L$
2. Dirichlet B.C.s at $x=0$ and Neuman B.C. at $x=L$  

Neuman 조건이 $x=0$에서 $x=L$에서 두번은 안됨.  
$\rightarrow$ 위치 기준이 없어져서 해가 무수히 많아지기 때문  
pf )  
$u(x)$를 만족하는 Neuman B.C.s 가 있고,  
미분방정식 : $$\underbrace{\frac{d\sigma}{dx}}_{\frac{d(Eu_{,x})}{dx}} +f=0$$ in $(0,L)$ 이 주어졌다고 하자.  

$u(x) + \overline{u}$ $\rightarrow$ $\overline{u}$는 미분하면 사라짐.  
$\Rightarrow$ 막대를 $\overline{u}$ 만큼 이동해도 응력분포나 힘 평형에는 변화가 없다.  

The solution $u(x)$ is non-unique up a rigid body motion,$\overline{u}$, which is a constant. Neuman B.C.s alone can be sepcified for the time-dependent elasticity problem. ( Hyperbolic PDE )  

### Bodyforce(체적력): $f(x)$  
$f(x)$: the forcing function in general PDEs  
e.g.  
g 방향으로 힘이 작용할 때 $f(x) = \rho(x)*g$  

### 미분 방정식: $\frac{d\sigma}{dx}+f(x)=0$ in $(0,L)$  
open interval 이여서 $x=0$과 $x=L$ 점은 포함되지 않는다.  
Have B.C.s either on $u(x)$ all on $u_{,x}$ at the boundary points.  

### The Constitutive relation  
$$\sigma = Eu_{,x}$$
$\sigma$: stress  
$u_{,x}$: strain - sometimes denoted by $\epsilon=u_{,x}$  
$E$: young's modulous  
  
  ## Heat Model
  The 1-D (scalar) linear elliptic problem also models heat on diffusive mass transport  
### Srong form:  
Find temperature $u(x)$ : $(0,L)$ $\mapsto$ $\mathbb{R'}$  
given $u_o$ and $u_g$ as $\overline{j}$, $f(x)$  

 the constitutive relation 
 $$
 \underbrace{j}_{\text{heat flux}}=-\kappa u_{,x}
 $$
 such that 
 $$
 \underbrace{-\frac{dj}{dx}}_{\text{divergence of the heat flux}}=f(x)$$ in $(0,L)$
   
   Boundary Conditions: $u(0) = u_o$ and $u(L) = u_g$ or $ j(L) = -\overline{j}$  
   $\overline{j}$: heating flux  

   $\rightarrow$ 여기서 Dirichlet 경계조건은 온도 조건이고 Neuman 경계조건은 열유속이다.  


## 최종 Strong form 형태  
Find $u(x)$ given $u_o$, $u_g$ or $t$ $f(x)$ and the constitutive relation $\sigma = E u_{,x}$ such that $\frac{d\sigma}{dx}+f=0$ in $(0,L)$ with B.C.s $u(0)=u_o$ and either $u(L)=u_g$  
(한마디로 초기조건, 구상방정식, 경계조건을 만족하는 $u(x)$를 찾아라)  
$\Rightarrow$ 주어진 식: $\frac{d}{dx}(E\frac{du}{dx})+f=0$ in $(0,L)$  
<br>
문제점 : strong form에서는 $u(x)$를 $x$에 대해서 미분을 두번 해야한다. 따라서 $u(x)$가 두번 미분 가능한 함수여야 한다. 이 문제를 해결하기 위해서 부분적분을 해서 두번 미분해야 하는 부분을 없애준다. (weak form 만드는 과정과 이유)
  
## Weak form:  
pf)  

$\int_0^y \frac{d\sigma}{dx} \,dx =\int_0^y -f\, dx$ where $y \in [0,L]$  
$\rightarrow$ $f$를 좌변으로 넘기고 $0$부터 $y$까지 적분  
$\sigma(y)-\sigma(0)= -\int_0^y f\, dx$   
$$
Eu_{,x}|_y -Eu_{,x}|_0= - \int_0^y f \, dx
$$   
$$
E\frac{du}{dy}=-\int_0^y f\, dx +E\frac{du}{dx}|_0
$$  
$\rightarrow$ 이 상태에서 양변을 $0$부터 $z$까지 적분  
$$
\int_0^z E\frac{du}{dy} \, dy= -\int_0^z (\int_0^y f\, dx) \,dy + \int_0^z E\frac{du}{dx}|_0 \, dy
$$  
$$
Eu(z)-Eu(0)= -\int_0^z (\int_0^y f\, dx) \,dy + \int_0^z E\frac{du}{dx}|_0 \, dy*z
$$  
$$
u(z)=\frac{1}{E}[\int_0^z (\int_0^y f\, dx) \,dy + \underbrace{E\frac{du}{dx}|_0 *z}_{\text{determined by applying b.c. at z=L}} + E\underbrace{u(0)}_{u_o}]
$$  
만약에 경계조건이 $x=L$에서 Neuman B.C.라면 처음에 $u_{,z}$ 먼저 계산하고 $Eu_{,x}$ 경계조건을 적용한다.  
  
  따라서 linear elliptic PDE in 1-D에서 weak foram은  
  Find $u(x) \in S=\{u|\underbrace{u(0)=u_o}_{\text{consider Dirichlet B.C. at x=0}}\}$  
  given $u_o,t,f(x)$ and constitutive relation $\sigma = Eu_{,x}$  
  such that $\forall w \in V =\{w| \underbrace{w(0)=0}_{\text{homogeneous Dirichlet B.C.}}\}$    

  $\Rightarrow$ 
  $$
  \int_0^L w_{,x}\sigma \underbrace{A \, dx}_{\text{volume element}} = \int_0^L w fA \, dx +w(L)\underbrace{tA}_{\text{boundary force}}
  $$

## Strong form $\Leftrightarrow$ Weak form

1. Stronf form을 Weak form으로   
Strong form : $\frac{d}{dx}\sigma +f =0$ in $(0,L)$  
B.C.s : $u(0)=u_o$  $\rightarrow$ Dirichlet B.C , $\sigma(L)=t$ , where $\sigma=Eu_{,x}$  
$w$: weighting fuction 도입  
$w \in V=\{w|w(0)=0\}$ $\rightarrow$ 끝에서 가상변위도 0이여야 해서  
$\int_0^L w\frac{d\sigma}{dx} + \int_0^L wf =0$ $\rightarrow$ 양변에 $w$를 곱해서 적분  
$$
-\int_0^L w_{,x}\sigma A \, dx + w\sigma A|_{0}^{L} + \int_0^L wAf \, dx =0
$$
$\rightarrow$ 적분법

$$
\int_0^L w_{,x}\sigma A \, dx = w \sigma A|_{0}^{L}+ \int_0^L wAf \,dx
$$  
$$
\int_0^L w_{,x}\sigma A \, dx =\int_0^L wAf \,dx +w(L)\sigma(L)A-w(0)\sigma(0)A
$$  
$\rightarrow \sigma(L)$은 Neuman B.C.에 의해서 $t$이고 homogeneous Dirichlet B.C.에 의해서 $w(0)=0$이다.  
$\therefore \int_0^L w_{,x}\sigma A \,dx =\int_0^L wf \,dx +w(L)tA $
3. Weak form을 Strong form으로  
Find $u \in S =\{u| u(0)=u_o\}$  
such that $\forall w \in V =\{w|w(0)=0\}$  
$$
\int_0^L w_{,x}\sigma A \, dx = \int_0^L wAf \, dx +w(L)tA 
$$ 
$\rightarrow$ weak form  
$$
-\int_0^L w\sigma_{,x}A \, dx + w\sigma A|_{0}^{L}= \int_0^L wAf \, dx +w(L)tA
$$  
$$
-\int_0^L w\sigma_{,x}A \, dx +w(L)\sigma(L)A -w(0)\sigma(0)A= \int_0^L wAf \, dx +w(L)tA
$$  
$\rightarrow w(0)=0$  
$$
\int_0^L w(-\sigma_{,x}-f)A\, dx +w(L)A(\sigma(L)-t)=0
$$  
$\Rightarrow w(x)$는 모든 허용가능한 함수이므로 잘 설정하면 strong form으로 변환이 가능하다.  
$w(x)=\phi(x)(-\sigma_{,x}-f)$라고 하자.  
$\phi(x)>0$ for $x \in (0,L)$  
$\phi(x)=0$ at $x=\{0,L\}$  
![alt text](image-1.png)  
$$
\int_0^L \underbrace{\phi(x)(-\sigma_{,x}-f)}_{w(x)}(-\sigma_{,x}-f)A \, dx=0
$$  
$$
\int_0^L \phi(x)(-\sigma_{,x}-f)^2A \, dx=0
$$  
$\rightarrow A, \phi(x)$ 모두 0보다 커야 해서 $-\sigma(L)-t=0$ 이여야 한다.  
$\therefore -\sigma_{,x}-f =0$ : PDE in strong form  
Return to 
$$
\int_0^L w(-\sigma_{,x}-f)A \, dx +w(L)A(\sigma(L)-t)=0
$$  
$\Rightarrow w(L)A(\sigma(L)-t)=0$ $\forall w \in V$  $\rightarrow$ $w(0)=0, w(L)\neq 0$  
$\Rightarrow \sigma(L)-t=0$: Neuma B.C. of the strong form  

## S와 V가 만족해야하는 공간 - Hilbert Space  
$L^2$: 함수를 제곱해서 적분하면 유한함?  
$H^1$: 함수랑 기울기도 제곱해서 적분하면 유한함?  
  
  $$H^1\in L^2$$
  u와 w가 속한 집합 $S,V$는 두번 미분해야해서  $H^1$에 속해야 한다.  
$\underline{\text{Remark}}$: $L^2$ 는 차원을 나타냄. $m(0,L)^{\frac{1}{d}}=L$  
$\rightarrow$ $d$: special dimension ,$m$ : measure of domain  
















