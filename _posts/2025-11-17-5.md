---
layout: post
title:  "FEM 시리즈 #5"
toc: true          # 우측 목차
toc_sticky: true   # 스크롤해도 고정
date: 2025-11-17
tags: [markdown, blog]
use_math: true
mathjax: true
---
## Linear parabolic pde in a scalar variable in 3D  

예. 비정상 상태의 열전도, 물질 확산 in 3D  

**Strong form**  

<img width="311" height="140" alt="image" src="https://github.com/user-attachments/assets/20f60263-9a4b-421d-ab24-0696f5be638e" />  

given $u_g, j_n, f$  
the constitutive relation : $ j_n = - K_{ij} u_{,j}$  
find $u(\underset{\sim}{x}, t)$ such that $$
\rho \frac{\partial u}{\partial t} = -j_{i,i} + f \quad \text{in} \quad \Omega \times [0, T]
$$  

B.C.s: $ u = u_g \quad \text{on} \quad \partial\Omega_u \\ -j_i n_i = j_n \quad \text{on} \quad \partial\Omega_j $  
Initial condition: $u(\underset{\sim}{x}, 0) = u_0(\underset{\sim}{x})$  

!! 문제 요약 !!  

온도나 농도를 나타내는 변수 $u$를 $t$와 $\underset{\sim}{x}$ 에 따라 어떻게 변하는지 예측  
$u$: 관심있는 물리량 (온도, 농도)  
$\underset{\sim}{x}$: (x,y,z) 좌표  
$\rho \frac{\partial u}{\partial t}$: 저장/변화 $\rightarrow$ 물리량이 얼마나 저장되는지 나타내는 계수  
$-j_{i,i}$ : 발산, - 기호는 유입된 양을 나타낸다.  
$f$ :  내부에서 생기는 열  

$\underline{\text{Remark}}$ : 열전도에서 $\rho$는 단위부피 당 비열(열용량)을 나타내고 질량 확산에서는 1이다. 그 이유는 단위부피 당 질량이 농도이기 때문이다.  

**Weak form**(infinite- dimensional)  

consider $w \in V = \{ w \mid w=0 \text{ on } \partial\Omega_u \}$  

$$
\int_{\Omega} w \rho \frac{\partial u}{\partial t} \,dV = \int_{\Omega} -w j_{i,i} \,dV + \int_{\Omega} w f \,dV \\
\int_{\Omega} w \rho \frac{\partial u}{\partial t} \,dV = \int_{\Omega} w_{,i} j_i \,dV + \int_{\Omega} w f \,dV - \int_{\partial\Omega} w j_i n_i \,dS
$$  

우변의 첫번째 항을 integrate by part 해주면 디리클레 경계에서는 표면에서 수직방향으로 나가는 양이 0이 되어 노이만 경계 항만 남게 된다.  

$$
\int_{\Omega} w \rho \frac{\partial u}{\partial t} \,dV = \int_{\Omega} w_{,i} \underbrace{j_i}_{=-K_{ij}u_{,j}} \,dV + \int_{\Omega} w f \,dV + \int_{\partial\Omega_j} w j_n \,dS
$$  

RHS에서 음수인 첫번째 항을 좌변으로 옮겨서 식정리를 해주면 최종식은 다음과 같다.  
$$
\int_{\Omega} w \rho \frac{\partial u}{\partial t} \,dV + \int_{\Omega} w_{,i} K_{ij} u_{,j} \,dV = \int_{\Omega} w f \,dV + \int_{\partial\Omega_j} w j_n \,dS
$$  

**Weak form**(finite-dimensional)  

infinite-dimension과 거의 동일.  

$$
\int_{\Omega} w^h \rho \frac{\partial u^h}{\partial t} \,dV + \int_{\Omega} w_{,i}^h K_{ij} u_{,j}^h \,dV = \int_{\Omega} w^h f \,dV + \int_{\partial\Omega_j} w^h j_n \,dS
$$  

위의 식 형태를 보면 steady state와 똑같은 항들하고 시간 term이 추가되어 있다. 따라서 동일한 항들은 steady state와 똑같이 쓰면 되고 시간항만 정리해주면 된다.  

동일한 항:  
$$
\int_{\Omega} w_{,i}^h K_{ij} u_{,j}^h \,dV = \underline{c}^T \underline{K} \underline{d}(t) \quad ; \quad \int_{\Omega} w^h f \,dV + \int_{\partial\Omega_j} w^h j_n \,dS = \underline{c}^T \underline{F}
$$  

다른 항(시간 term 추가):  
$$
\int_{\Omega} w^h \rho \frac{\partial u^h}{\partial t} \,dV
$$  

use $\frac{\partial u^h}{\partial t} \Big|_e = \sum_A N^A \dot{d}_e^A$  
시간에 대해서 미분된 항이 있으니까 자유도를 시간으로 미분한 항으로 계산해주면 된다. 여기서 $\dot{d}_e^A$는 그 노드에서 온도가 시간에 따라 얼마나 빨리 변하는지를 나타낸다.  

$$
\int_{\Omega} w^h \rho \frac{\partial u^h}{\partial t} \,dV = \sum_e \int_{\Omega^e} \left( \sum_A N^A c_e^A \right) \rho \left( \sum_B N^B \dot{d}_e^B \right) \,dV = \sum_e \sum_{A,B} c_e^A \underbrace{\left( \int_{\Omega^e} N^A \rho N^B \,dV \right)}_{M_e^{AB}} \dot{d}_e^B
$$  












